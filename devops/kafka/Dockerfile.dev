FROM confluentinc/cp-kafka:7.6.0

USER root
# Use the built-in Python; just add pip (via ensurepip) and PyYAML + backport
RUN python3 -m ensurepip --upgrade || true \
 && python3 -m pip install --no-cache-dir --upgrade pip \
 && python3 -m pip install --no-cache-dir pyyaml importlib-metadata

COPY create-topics.py /usr/local/bin/create-topics.py
COPY topics.yaml /usr/local/bin/topics.yaml

CMD ["/etc/confluent/docker/run"]